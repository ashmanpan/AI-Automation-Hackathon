version: 1
backend:
  phases:
    build:
      commands:
        - '# Execute Amplify CLI with the helper script'
        - amplifyPush --simple

frontend:
  phases:
    preBuild:
      commands:
        - cd backend
        - npm ci
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: backend/dist
    files:
      - '**/*'
  cache:
    paths:
      - backend/node_modules/**/*

# Environment variables needed (set in Amplify Console):
# NODE_ENV=production
# DB_HOST=<RDS-ENDPOINT>
# DB_PORT=5432
# DB_NAME=hackathon_platform
# DB_USER=postgres
# DB_PASSWORD=<SECURE-PASSWORD>
# JWT_SECRET=<YOUR-JWT-SECRET>
# AWS_REGION=us-east-1
# AWS_S3_BUCKET=<YOUR-S3-BUCKET>
# USE_AWS_S3=true
# USE_MINIO=false
# OPENAI_API_KEY=<YOUR-OPENAI-KEY>
# OPENAI_MODEL=gpt-4-turbo-preview
# OPENAI_MAX_TOKENS=2000
# AI_GRADING_ENABLED=true
# AI_GRADING_AUTO=false
